from app.main import app


def test_add_and_get_service(monkeypatch):
    client = app.test_client()
    data = {"name": "svc1", "url": "http://example.com", "interval": 1}
    resp = client.post('/service', json=data)
    assert resp.status_code == 201
    status = client.get('/service/svc1')
    assert status.status_code == 200
    json = status.get_json()
    assert json['name'] == 'svc1'


def test_missing_fields():
    client = app.test_client()
    resp = client.post('/service', json={"name": ""})
    assert resp.status_code == 400
